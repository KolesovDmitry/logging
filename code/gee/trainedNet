var neural = require("users/kolesovdm/Neural:MLP_array");

/*
Обученные нейросети:
 * поиск изменений;
 * поиск облаков.

*/

//////////////////////////////////////////////////
// Изменения
//////////////////////////////////////////////////


// Сеть для прогноза давностей на базе Пуассоновской модели
// Входы (перепутан порядок nir-red!!!): 
// "blue", "blue_1",  "green", "green_1", "nir", "nir_1", "red", "red_1", "swir1", "swir1_1", "swir2", "swir2_1", "change"]
// blue == медианные срезы, blue_1 == ожидаемые медианные срезы
var p_w1 = ee.Array([
[1.468922019004821777e+00, -7.711576819419860840e-01, -1.825606346130371094e+00, -7.280289530754089355e-01, -1.499327272176742554e-01, -8.640007972717285156e-01, 1.216069534420967102e-01, 1.923688054084777832e-01, -1.223804712295532227e+00, -9.833427667617797852e-01, 5.479509234428405762e-01, -2.752910852432250977e-01, -1.110468874685466290e-03, -5.852166563272476196e-02, -2.529137849807739258e+00, -9.679478406906127930e-02, 1.186093240976333618e-01, 2.416279792785644531e+00, -4.846071302890777588e-01, -4.228715419769287109e+00],
[-1.695299446582794189e-01, 1.817705184221267700e-01, 4.357082247734069824e-01, -9.249113798141479492e-01, 1.084062814712524414e+00, -3.758982717990875244e-01, -1.140586256980895996e+00, 5.391879677772521973e-01, -7.629415392875671387e-02, -5.240011811256408691e-01, 9.934786558151245117e-01, -8.926191329956054688e-01, -5.742483735084533691e-01, -2.723337151110172272e-02, -3.428048849105834961e+00, -6.337462663650512695e-01, -3.878238201141357422e-01, 1.943487763404846191e+00, -8.217110037803649902e-01, -9.983004927635192871e-01],
[-7.583748102188110352e-01, -5.159537121653556824e-02, -9.602681398391723633e-01, 3.026851415634155273e-01, -4.015476405620574951e-01, -2.275951653718948364e-01, 1.751456975936889648e+00, 4.208115637302398682e-01, 6.161985397338867188e-01, -2.111334949731826782e-01, 4.418960958719253540e-02, -5.821082592010498047e-01, 1.233101189136505127e-01, -5.767391324043273926e-01, 1.235008120536804199e+00, -8.803147822618484497e-02, -2.309208661317825317e-01, 1.642948836088180542e-01, -3.320983052253723145e-01, -1.822085380554199219e+00],
[-4.350073337554931641e-01, -1.723769456148147583e-01, -1.499549031257629395e+00, 1.305599063634872437e-01, -1.445743143558502197e-01, 9.552606195211410522e-02, 7.760389447212219238e-01, -4.073820263147354126e-02, 6.038442999124526978e-02, 9.689828753471374512e-01, 3.098501563072204590e-01, -8.873794674873352051e-01, 1.993683874607086182e-01, 2.514928877353668213e-01, 1.983871102333068848e+00, 7.912125587463378906e-01, 1.491107046604156494e-01, 6.973078250885009766e-01, -6.663568019866943359e-01, 6.421988606452941895e-01],
[1.837911725044250488e+00, -4.208884239196777344e-01, 1.360338032245635986e-01, 4.323393106460571289e-01, 2.133649736642837524e-01, 7.061501145362854004e-01, 4.341291785240173340e-01, -2.281890660524368286e-01, 1.461743354797363281e+00, -1.792806744575500488e+00, -9.909952878952026367e-01, -1.813173294067382812e-01, -3.585156798362731934e-01, -3.465535640716552734e-01, -3.425831347703933716e-02, -2.127188891172409058e-01, -3.367913961410522461e-01, -1.294032931327819824e+00, -9.840290248394012451e-02, -3.198718428611755371e-01],
[-1.249264121055603027e+00, 2.927743792533874512e-01, 1.164716124534606934e+00, -3.118790090084075928e-01, -1.165268301963806152e+00, -1.628048658370971680e+00, -2.534490227699279785e-01, -5.158647894859313965e-01, -3.424433767795562744e-01, 1.138470768928527832e-01, 1.372151732444763184e+00, -5.068678259849548340e-01, -2.399641871452331543e-01, 1.405662000179290771e-01, 3.903081119060516357e-01, -1.151687026023864746e+00, -1.214117258787155151e-01, -2.273666858673095703e-01, -9.474682062864303589e-02, -3.431769311428070068e-01],
[-1.428349852561950684e+00, -4.450156092643737793e-01, -1.704995512962341309e+00, -5.634963512420654297e-01, -2.649412155151367188e-01, 8.658488094806671143e-02, -1.289417982101440430e+00, -4.527862370014190674e-01, -2.988043129444122314e-01, 8.426030874252319336e-01, 5.744189023971557617e-01, -7.172935605049133301e-01, -2.422328740358352661e-01, -3.690360859036445618e-02, 1.517686605453491211e+00, -8.754053115844726562e-01, 4.770509526133537292e-02, -1.323522448539733887e+00, 9.643459320068359375e-01, 2.186712980270385742e+00],
[2.032400816679000854e-01, 1.134187215939164162e-03, 7.153581380844116211e-01, 1.175390705466270447e-01, 4.232771098613739014e-01, 8.204101324081420898e-01, 3.550756722688674927e-02, -2.922641932964324951e-01, 5.133705139160156250e-01, -7.336136102676391602e-01, 6.548221111297607422e-01, 3.484571725130081177e-02, -3.566237390041351318e-01, -2.679220587015151978e-02, 3.852532431483268738e-02, 1.390877485275268555e+00, 2.685566842555999756e-01, -4.197751730680465698e-02, 9.503874182701110840e-02, 1.701510548591613770e+00],
[-1.344744682312011719e+00, -5.581005811691284180e-01, -1.668054223060607910e+00, -6.373297572135925293e-01, -6.661753058433532715e-01, 8.481262922286987305e-01, -2.813809514045715332e-01, -1.738338768482208252e-01, 1.688894510269165039e+00, 2.399909496307373047e+00, 1.146390557289123535e+00, -4.328626394271850586e-02, 1.868208646774291992e-01, -2.706310451030731201e-01, 3.489778995513916016e+00, -1.362726926803588867e+00, 6.287204623222351074e-01, 4.532407224178314209e-01, -7.214162945747375488e-01, 4.137952327728271484e+00],
[-2.871840476989746094e+00, 2.731794118881225586e-01, 2.187233716249465942e-01, 3.721681833267211914e-01, 1.773487567901611328e+00, 1.467655062675476074e+00, 3.542931318283081055e+00, -2.218772172927856445e-01, -1.633761763572692871e+00, -8.332385420799255371e-01, 2.501645803451538086e+00, -7.066371440887451172e-01, 1.539682447910308838e-01, -2.546745836734771729e-01, -1.157958745956420898e+00, 2.179234504699707031e+00, -2.594726383686065674e-01, -2.146386146545410156e+00, -1.940326839685440063e-01, -4.893840849399566650e-02],
[-9.606791734695434570e-01, -6.906509399414062500e-02, 3.447052001953125000e+00, 6.664645671844482422e-01, 1.730158925056457520e+00, 1.179011344909667969e+00, -2.579506635665893555e+00, -2.021509706974029541e-01, 4.699558913707733154e-01, 1.773964762687683105e+00, -7.341699600219726562e-01, 1.410588026046752930e-01, -4.926946163177490234e-01, -5.214811563491821289e-01, -3.897973775863647461e+00, 1.851802468299865723e-01, 4.475292861461639404e-01, 1.690790176391601562e+00, 1.722885966300964355e-01, -7.399881482124328613e-01],
[5.528914451599121094e+00, -5.299401283264160156e-01, 5.906389355659484863e-01, 3.696024417877197266e-01, -1.079957604408264160e+00, -1.617455720901489258e+00, 1.772728562355041504e-01, 2.051218897104263306e-01, -1.257794260978698730e+00, -1.436318874359130859e+00, -1.627752900123596191e+00, 5.698816180229187012e-01, -9.456806629896163940e-02, -4.840511381626129150e-01, -1.516618251800537109e+00, 1.865135312080383301e+00, -1.746889650821685791e-01, -1.222707867622375488e+00, 5.802760124206542969e-01, -1.808167546987533569e-01]
]);

var p_w2 = ee.Array([
[-3.921538591384887695e-01, 1.036772429943084717e-01, 1.449217677116394043e+00, -7.266458123922348022e-02, 3.727692365646362305e+00, 3.509839773178100586e-01, -3.891495242714881897e-02, 2.253859490156173706e-01, 1.511597275733947754e+00, -3.628679752349853516e+00, -4.156040251255035400e-01, -1.004039645195007324e+00, -4.732108116149902344e-01, -7.542705535888671875e-01, 1.172311529517173767e-01],
[6.191347837448120117e-01, 5.083969831466674805e-01, 1.470258533954620361e-01, -3.192768096923828125e-01, -1.845149695873260498e-02, -5.834029912948608398e-01, 3.780438601970672607e-01, -2.664066553115844727e-01, -2.608209550380706787e-01, -1.552331894636154175e-01, -4.084507822990417480e-01, -2.500501647591590881e-02, -2.544470131397247314e-01, 5.862180516123771667e-02, -7.513028979301452637e-01],
[1.035874962806701660e+00, 2.308186441659927368e-01, -2.347318977117538452e-01, -1.785563081502914429e-01, -2.418061256408691406e+00, 3.151024281978607178e-01, -6.920089721679687500e-01, 4.618555605411529541e-01, -5.556689500808715820e-01, -2.863116264343261719e+00, -2.714329957962036133e-01, 2.199300080537796021e-01, 1.470750689506530762e+00, -5.019953250885009766e-01, 2.826410233974456787e-01],
[-1.135213300585746765e-01, 4.483676254749298096e-01, -3.336529433727264404e-01, -1.040561031550168991e-02, 6.583684086799621582e-01, 9.401275962591171265e-02, -3.493494167923927307e-02, -4.590400457382202148e-01, 9.741286933422088623e-02, -4.890086874365806580e-02, -2.357866466045379639e-01, 5.911259651184082031e-01, 1.346296966075897217e-01, -3.665610551834106445e-01, 6.135157123208045959e-02],
[1.465783238410949707e+00, -6.158812642097473145e-01, -2.047481685876846313e-01, -9.430217742919921875e-01, 6.969328522682189941e-01, -4.385613203048706055e-01, 2.474236041307449341e-01, 6.460288763046264648e-01, -2.587643146514892578e+00, 3.307190239429473877e-01, 1.404332816600799561e-01, 3.308438062667846680e-01, 1.831038117408752441e+00, -1.334994733333587646e-01, -3.601695001125335693e-01],
[1.455867409706115723e+00, -2.954306304454803467e-01, 4.954276680946350098e-01, -1.085873842239379883e+00, -3.197777509689331055e+00, 1.456779092550277710e-01, -1.645411401987075806e-01, 3.723976910114288330e-01, 1.710595637559890747e-01, -2.937485456466674805e+00, -9.449713230133056641e-01, 1.210083484649658203e+00, 1.109026312828063965e+00, 3.527150154113769531e-01, -9.445983767509460449e-01],
[1.499721884727478027e+00, -1.823271214962005615e-01, -1.751930832862854004e+00, 1.497671604156494141e-01, -2.117617845535278320e+00, 3.101845383644104004e-01, 1.793695241212844849e-01, 4.389637112617492676e-01, -5.550562739372253418e-01, -5.316669940948486328e+00, -3.296310305595397949e-01, -6.199476718902587891e-01, 2.132315158843994141e+00, -2.174901664257049561e-01, -2.782149314880371094e-01],
[-5.181461572647094727e-01, -3.866119980812072754e-01, 9.910954535007476807e-02, -8.292264491319656372e-02, -4.657581448554992676e-02, -4.384604394435882568e-01, 2.833239138126373291e-01, -3.714996576309204102e-01, 1.793763935565948486e-01, -1.448899805545806885e-01, -5.675085261464118958e-02, 2.281227111816406250e-01, 1.739877834916114807e-02, 2.844298444688320160e-02, 8.426436781883239746e-01],
[-7.645697146654129028e-02, 1.716982126235961914e-01, -2.006304979324340820e+00, 3.359098732471466064e-01, 1.032208055257797241e-01, 6.253541707992553711e-01, -3.552785813808441162e-01, 2.219099104404449463e-01, -2.026009559631347656e-01, -1.961024045944213867e+00, -6.175966858863830566e-01, -7.949234247207641602e-01, -9.607499092817306519e-02, 6.878327727317810059e-01, -2.109673619270324707e-01],
[-3.469454050064086914e-01, 3.769132196903228760e-01, -2.071875095367431641e+00, 1.011034727096557617e+00, -2.183707714080810547e+00, -2.416630387306213379e-01, 3.827379345893859863e-01, -7.373677194118499756e-02, 7.474744915962219238e-01, -1.000590771436691284e-01, 5.497080683708190918e-01, -2.863181531429290771e-01, 1.883099600672721863e-02, 5.358702540397644043e-01, -4.141456782817840576e-01],
[7.818337678909301758e-01, -6.569467186927795410e-01, -1.447976231575012207e+00, -6.263271206989884377e-04, -3.037350177764892578e+00, 1.074074357748031616e-01, -1.239639073610305786e-01, 9.228242933750152588e-02, -1.092445850372314453e+00, -2.492722749710083008e+00, -2.276963889598846436e-01, -3.222794532775878906e-01, 8.967145681381225586e-01, -1.220216035842895508e+00, -8.067547082901000977e-01],
[2.933654487133026123e-01, -3.370195329189300537e-01, 3.118869960308074951e-01, 7.758404016494750977e-01, 8.428770899772644043e-01, -5.281769633293151855e-01, 4.532021880149841309e-01, -3.852823972702026367e-01, 4.447342157363891602e-01, -1.544235050678253174e-01, 8.976767659187316895e-01, -5.610746741294860840e-01, -2.892283499240875244e-01, -4.579674303531646729e-01, -3.082848154008388519e-02],
[-1.249252334237098694e-01, 7.353872656822204590e-01, -2.684365510940551758e-01, 2.233497351408004761e-01, -5.718402862548828125e-01, 9.052704274654388428e-02, -6.034545972943305969e-02, -7.746514678001403809e-01, -1.879181265830993652e-01, -1.728764772415161133e-01, 8.476143479347229004e-01, 5.628178119659423828e-01, -5.702092647552490234e-01, -3.633758723735809326e-01, 3.605788648128509521e-01],
[-4.748774766921997070e-01, 8.866528868675231934e-01, 5.342569351196289062e-01, -4.311549067497253418e-01, 2.831754386425018311e-01, 1.310196965932846069e-01, 6.323834657669067383e-01, 1.350504159927368164e-01, 7.903279066085815430e-01, 1.739394515752792358e-01, -6.839533448219299316e-01, -2.849548161029815674e-01, -8.782833218574523926e-01, -2.502134740352630615e-01, 1.197246238589286804e-01],
[-3.625524342060089111e-01, -1.711704283952713013e-01, -9.597659111022949219e-01, -5.609289184212684631e-02, 9.191781282424926758e-01, 1.871595382690429688e-01, 9.275215864181518555e-02, 7.246021181344985962e-02, 4.705554991960525513e-02, -2.609046459197998047e+00, -4.594208300113677979e-01, -4.669917225837707520e-01, -6.582543253898620605e-01, -9.156631678342819214e-02, 3.705185353755950928e-01],
[-3.970976471900939941e-01, -5.263463854789733887e-01, -2.005199909210205078e+00, 1.530136018991470337e-01, -1.182563543319702148e+00, -7.556602954864501953e-01, 7.075592279434204102e-01, -6.816662102937698364e-02, -5.152314305305480957e-01, 3.624477237462997437e-02, -2.222145199775695801e-01, -5.436505079269409180e-01, -6.090252399444580078e-01, -4.393999278545379639e-01, -4.463891685009002686e-01],
[-9.042590856552124023e-01, 3.370237350463867188e-02, -6.308141350746154785e-02, -1.804918795824050903e-01, 6.816154122352600098e-01, 5.419989228248596191e-01, 6.428551077842712402e-01, -8.011875748634338379e-01, 2.005031257867813110e-01, -1.902411431074142456e-01, -1.987942010164260864e-01, 2.563264667987823486e-01, 7.775449156761169434e-01, 8.265187591314315796e-02, 1.772777438163757324e-01],
[1.095658242702484131e-01, 5.152300596237182617e-01, -6.416770219802856445e-01, 2.947144806385040283e-01, -1.690887093544006348e+00, 1.560577750205993652e-01, -3.851561248302459717e-01, 4.934494197368621826e-01, 2.150241285562515259e-01, -3.261135816574096680e+00, 4.435238242149353027e-01, -5.351663231849670410e-01, 1.154924631118774414e+00, -8.754864931106567383e-01, 1.881752908229827881e-01],
[-6.328107714653015137e-01, -7.323005199432373047e-01, -2.731963805854320526e-02, 1.788669079542160034e-02, 1.134908869862556458e-01, 3.687814176082611084e-01, -6.358300447463989258e-01, -2.982195317745208740e-01, 1.271693706512451172e-01, -8.631058782339096069e-02, -3.004211485385894775e-01, -5.827059149742126465e-01, 8.470516651868820190e-02, 1.007388353347778320e+00, -3.952953815460205078e-01],
[-7.234942317008972168e-01, -2.496313899755477905e-01, 1.132835865020751953e+00, 2.291415184736251831e-01, 2.431745052337646484e+00, 1.539615243673324585e-01, -5.771908760070800781e-01, 5.410132408142089844e-01, -3.697259724140167236e-01, 1.618162870407104492e+00, 1.941212564706802368e-01, 6.540842354297637939e-02, -9.731660038232803345e-02, -1.013426929712295532e-01, -9.103298783302307129e-01]
]);

var p_w3 = ee.Array([
[7.334862947463989258e-01],
[-2.312066555023193359e-01],
[-1.862383008003234863e+00],
[2.695199549198150635e-01],
[-1.569985985755920410e+00],
[1.149999126791954041e-01],
[-4.242917895317077637e-01],
[6.093087792396545410e-01],
[2.908301830291748047e+00],
[1.786576509475708008e+00],
[4.515834450721740723e-01],
[-1.680087000131607056e-01],
[-6.164928078651428223e-01],
[-1.656175613403320312e+00],
[-5.024642944335937500e-01]
]);

var p_b1 = ee.Array.cat([ee.Array([
-5.220062285661697388e-02,
0.000000000000000000e+00,
6.704983115196228027e-01,
-8.872453868389129639e-02,
1.290643215179443359e-01,
9.425386190414428711e-01,
1.975761950016021729e-01,
-2.397424727678298950e-01,
-2.372981607913970947e-01,
6.062513217329978943e-02,
-8.182743191719055176e-01,
0.000000000000000000e+00,
0.000000000000000000e+00,
-7.900853641331195831e-03,
4.066956937313079834e-01,
1.973935514688491821e-01,
-1.877273470163345337e-01,
-2.322314679622650146e-01,
-9.970444440841674805e-02,
5.516269207000732422e-01
])], 1).transpose();

var p_b2 = ee.Array.cat([ee.Array([
8.668463230133056641e-01,
-3.217462822794914246e-02,
3.583206534385681152e-01,
1.062664270401000977e+00,
3.994816541671752930e+00,
-2.441443353891372681e-01,
-5.977348089218139648e-01,
-7.289407402276992798e-02,
1.363493949174880981e-01,
5.260738372802734375e+00,
1.509967803955078125e+00,
-7.045052051544189453e-01,
-2.545079469680786133e+00,
-2.227934747934341431e-01,
-2.524317614734172821e-02
])], 1).transpose();

var p_b3 = ee.Array.cat([ee.Array([2.619739472866058350e-01])], 1).transpose();

var changePoisson = Object.create(neural.MLP.poissonMLP);
changePoisson.init(ee.List([p_w1, p_w2, p_w3]), ee.List([p_b1, p_b2, p_b3]));



var ch_w1 = ee.Array([
[6.687991023063659668e-01, -4.048167765140533447e-01, 1.249131038784980774e-01, 7.566443085670471191e-01, -2.542980946600437164e-02, 1.551294326782226562e-01, 3.670422732830047607e-01, 7.920403778553009033e-02, -2.233251743018627167e-02, -7.807892560958862305e-01, -4.530669748783111572e-01, -3.877239227294921875e-01, -5.877779722213745117e-01, -1.910503767430782318e-02, -9.104228615760803223e-01, -6.644065380096435547e-01, -2.783846259117126465e-01, 2.828760743141174316e-01, 9.229997396469116211e-01, 4.021555781364440918e-01, -2.765258960425853729e-02, 1.976654082536697388e-01, 2.737800180912017822e-01, 6.094492077827453613e-01, -2.112585902214050293e-01],
[6.203174591064453125e-01, -6.265554428100585938e-01, -2.931345626711845398e-02, 2.417858340777456760e-04, -7.767978310585021973e-02, -1.840177625417709351e-01, -6.831812858581542969e-01, 1.106773037463426590e-02, 6.332675218582153320e-01, -6.283377408981323242e-01, -8.177934885025024414e-01, -8.132622838020324707e-01, 2.058055251836776733e-01, -3.193881511688232422e-01, -1.071665659546852112e-01, -4.076099395751953125e-01, -7.325258105993270874e-02, 1.888756453990936279e-01, 2.967824339866638184e-01, -2.204518616199493408e-01, -2.891081944108009338e-02, -2.351877689361572266e-01, -4.129408597946166992e-01, 1.041982844471931458e-01, -4.763056635856628418e-01],
[6.811122894287109375e-01, 1.470548957586288452e-01, -1.954049617052078247e-01, 3.958699703216552734e-01, 2.576105296611785889e-01, -4.820187389850616455e-01, -1.867938935756683350e-01, 2.527718842029571533e-01, -1.143466904759407043e-01, -2.431311905384063721e-01, -4.729171991348266602e-01, 2.864645719528198242e-01, -3.045709729194641113e-01, 7.234526425600051880e-02, -5.447567626833915710e-02, -8.489312529563903809e-01, -4.399052560329437256e-01, -4.995021522045135498e-01, -2.332413047552108765e-01, -3.182345926761627197e-01, 3.390340805053710938e-01, -6.794751882553100586e-01, 3.515241742134094238e-01, 4.533012583851814270e-02, 4.776837229728698730e-01],
[-1.546136885881423950e-01, 5.398910045623779297e-01, -9.715209901332855225e-02, 1.949597597122192383e-01, 2.356854528188705444e-01, -7.379997372627258301e-01, 4.042950272560119629e-01, 5.740109086036682129e-01, -5.478612780570983887e-01, 1.807606220245361328e-01, -1.589999645948410034e-01, -8.006753921508789062e-01, 4.116498529911041260e-01, -3.040527552366256714e-02, -2.205386292189359665e-03, -3.502967953681945801e-01, 2.205491960048675537e-01, 3.814424276351928711e-01, -2.183381617069244385e-01, 3.633924126625061035e-01, 1.673477739095687866e-01, -6.996027231216430664e-01, 2.742862999439239502e-01, -8.301804661750793457e-01, -7.397274971008300781e-01],
[-3.979827463626861572e-02, -7.290984392166137695e-01, -3.112799227237701416e-01, 1.501289308071136475e-01, -2.583487927913665771e-01, 4.958210289478302002e-01, -5.018514394760131836e-01, 4.310580193996429443e-01, 1.134026423096656799e-01, -6.100747585296630859e-01, -2.990134060382843018e-01, -1.268370747566223145e-01, 7.179629802703857422e-01, -6.947602629661560059e-01, 1.258960515260696411e-01, 4.227293729782104492e-01, 3.988819196820259094e-02, -5.256774425506591797e-01, 2.228126674890518188e-01, -8.672732114791870117e-02, 6.447106599807739258e-01, 1.019355952739715576e-01, 1.750668585300445557e-01, -1.480165868997573853e-01, -1.937483996152877808e-01],
[-1.219456046819686890e-01, -5.988134741783142090e-01, 4.734105169773101807e-01, 1.825944483280181885e-01, -5.401728153228759766e-01, -3.147287759929895401e-03, -3.261024355888366699e-01, 2.300451099872589111e-01, 2.572731673717498779e-01, 1.472473442554473877e-01, -4.918937683105468750e-01, 1.840070039033889771e-01, -2.053237408399581909e-01, 5.439053773880004883e-01, -5.529059767723083496e-01, 6.792067885398864746e-01, 2.888674139976501465e-01, -1.995155364274978638e-01, 5.305303335189819336e-01, -8.018232583999633789e-01, 2.141254842281341553e-01, 2.884702980518341064e-01, -2.776888906955718994e-01, -9.316381216049194336e-01, 2.158549726009368896e-01],
[-2.871612906455993652e-01, -1.796840280294418335e-01, -1.603401601314544678e-01, 5.990844219923019409e-02, -5.728437304496765137e-01, 8.422465920448303223e-01, 7.559137940406799316e-01, 3.382310569286346436e-01, 1.223738074302673340e+00, -5.412684082984924316e-01, 1.059963703155517578e+00, -3.492482900619506836e-01, -1.062566936016082764e-01, -6.399004459381103516e-01, 3.749687969684600830e-02, 3.578234016895294189e-01, -9.302827715873718262e-01, -2.103885263204574585e-01, -8.015634417533874512e-01, -8.214122802019119263e-02, 1.090551733970642090e+00, 2.721247375011444092e-01, -6.783716678619384766e-01, -2.434561401605606079e-01, 2.728568315505981445e-01],
[4.211699962615966797e-01, 9.063008427619934082e-02, -1.880990713834762573e-02, 1.059504002332687378e-01, -2.063642293214797974e-01, -2.859174311161041260e-01, -8.052622079849243164e-01, -3.355311751365661621e-01, -3.547410070896148682e-01, 1.828330755233764648e-02, 5.067905783653259277e-01, -6.365061998367309570e-01, -4.499609172344207764e-01, -2.147276848554611206e-01, -1.224834173917770386e-01, 5.459049344062805176e-01, 6.662597060203552246e-01, 3.127111196517944336e-01, 7.505760192871093750e-01, -1.386195048689842224e-02, 8.571600168943405151e-02, -2.721081674098968506e-01, -5.641065239906311035e-01, -3.832510709762573242e-01, 3.095690533518791199e-02],
[-5.821759104728698730e-01, 7.637391090393066406e-01, 5.667951107025146484e-01, -5.426620841026306152e-01, -2.475968152284622192e-01, 2.171065956354141235e-01, 7.694598436355590820e-01, 6.876337528228759766e-01, -3.648279011249542236e-01, -1.857307404279708862e-01, -6.018656492233276367e-01, 8.681484460830688477e-01, 7.282957434654235840e-02, -3.434816300868988037e-01, 1.643105298280715942e-01, 1.784729510545730591e-01, -2.385724484920501709e-01, 1.560532003641128540e-01, 1.819420009851455688e-01, -1.353457421064376831e-01, 3.280086815357208252e-01, -4.462947547435760498e-01, 2.967015802860260010e-01, 3.491769134998321533e-01, 1.206756010651588440e-01],
[-2.111297696828842163e-01, 3.165512159466743469e-02, -1.874696463346481323e-01, 4.554134309291839600e-01, -3.989207446575164795e-01, -4.046794772148132324e-01, -2.579974569380283356e-02, -3.217974677681922913e-03, -4.274588525295257568e-01, -7.479935288429260254e-01, -5.216991305351257324e-01, -1.322551816701889038e-01, -7.921857386827468872e-02, 3.221627175807952881e-01, 4.293040335178375244e-01, 8.698833733797073364e-02, 1.192443892359733582e-01, -2.667925953865051270e-01, -2.432280965149402618e-02, -5.382454395294189453e-01, -3.459513485431671143e-01, -7.262246608734130859e-01, -5.473271608352661133e-01, 7.030431926250457764e-02, 7.123913764953613281e-01],
[9.770538210868835449e-01, 4.808557033538818359e-01, 3.286628797650337219e-02, 6.045024469494819641e-02, -5.910435318946838379e-01, 1.664248257875442505e-01, 1.237906292080879211e-01, 5.140125155448913574e-01, -8.856642246246337891e-01, -6.142856478691101074e-01, -2.242164462804794312e-01, 6.904865056276321411e-02, -4.209591746330261230e-01, 4.140432775020599365e-01, 3.211544454097747803e-01, 5.451105535030364990e-02, -6.167896986007690430e-01, 1.288701146841049194e-01, 4.636467099189758301e-01, 4.269354045391082764e-01, -3.269349932670593262e-01, -1.300921440124511719e-01, -2.556134462356567383e-01, 4.749155044555664062e-01, -1.369667202234268188e-01],
[6.758840084075927734e-01, -1.787716746330261230e-01, 2.624316811561584473e-01, 2.727437615394592285e-01, -3.584693670272827148e-01, -8.727747201919555664e-02, 8.710557222366333008e-02, 3.941992223262786865e-01, -9.681160449981689453e-01, -2.942735552787780762e-01, 6.583742499351501465e-01, 1.752539128065109253e-01, -7.994509935379028320e-01, 2.274760156869888306e-01, 3.965179920196533203e-01, -1.576625853776931763e-01, -3.956253640353679657e-03, 2.037441581487655640e-01, 2.292208522558212280e-01, -8.631177991628646851e-02, 2.263714969158172607e-01, -2.743678390979766846e-01, -3.508010804653167725e-01, -4.200021624565124512e-01, 6.215919852256774902e-01]
]);

var ch_w2 = ee.Array([
[-1.422200351953506470e-01, 1.169481158256530762e+00, 8.120372891426086426e-03, 1.596807986497879028e-01, 3.862631022930145264e-01],
[-8.234494924545288086e-01, 5.461076498031616211e-01, 2.302675545215606689e-01, 4.708710685372352600e-02, 3.499924540519714355e-01],
[-2.174817919731140137e-01, -8.498107083141803741e-03, -4.609132409095764160e-01, -1.565909944474697113e-02, -2.019357532262802124e-01],
[-6.519630551338195801e-01, 8.299874067306518555e-01, -8.265497684478759766e-01, 2.158702909946441650e-01, 4.077471494674682617e-01],
[-1.883205026388168335e-01, -5.743569135665893555e-02, 5.211144089698791504e-01, -5.702508091926574707e-01, 7.957292795181274414e-01],
[4.077048897743225098e-01, -6.399667859077453613e-01, -7.684238255023956299e-02, -2.117313444614410400e-01, 6.765509247779846191e-01],
[-6.968325972557067871e-01, 7.526611089706420898e-01, 3.212698101997375488e-01, 3.061283528804779053e-01, 4.974033832550048828e-01],
[-9.324252605438232422e-02, 4.406077563762664795e-01, 1.110741272568702698e-01, 4.477403163909912109e-01, -3.002864122390747070e-01],
[-3.971043825149536133e-01, -1.298066377639770508e+00, 2.983970046043395996e-01, -3.598330616950988770e-01, 4.020661115646362305e-01],
[-5.605270862579345703e-01, -2.465354353189468384e-01, -3.997774720191955566e-01, 2.112120240926742554e-01, -1.920360475778579712e-01],
[-4.816825985908508301e-01, 1.269893884658813477e+00, 6.809531450271606445e-01, -4.645842611789703369e-01, -1.032700762152671814e-01],
[1.559510827064514160e-01, 3.483805954456329346e-01, 6.049790978431701660e-01, -2.036672979593276978e-01, 1.158614829182624817e-01],
[1.304187625646591187e-01, -6.095747351646423340e-01, -3.974876403808593750e-01, 1.452228426933288574e-01, -6.539249420166015625e-02],
[-5.493887066841125488e-01, 8.850366622209548950e-02, 6.073799133300781250e-01, 3.925873935222625732e-01, -3.182451725006103516e-01],
[3.470750898122787476e-02, -5.825204253196716309e-01, -1.706846803426742554e-01, -4.051396846771240234e-01, 1.669572293758392334e-01],
[-4.658681452274322510e-01, -2.188663333654403687e-01, -2.474943995475769043e-01, 4.547164961695671082e-02, -6.956387162208557129e-01],
[-5.095686018466949463e-02, 9.343860149383544922e-01, 3.360904753208160400e-01, 1.114740371704101562e-01, 3.647729158401489258e-01],
[-3.945153672248125076e-03, -2.874498367309570312e-01, 3.423761576414108276e-02, -5.431831479072570801e-01, -7.620566487312316895e-01],
[5.474115610122680664e-01, 1.545383453369140625e+00, -9.971532970666885376e-02, -8.148165792226791382e-02, 4.442276358604431152e-01],
[1.225368082523345947e-01, 5.797210335731506348e-01, -1.784478873014450073e-01, 3.448189198970794678e-01, -6.949318200349807739e-02],
[-6.963750720024108887e-01, -6.281412839889526367e-01, -2.977226078510284424e-01, 2.517986595630645752e-01, 6.677115559577941895e-01],
[5.181868746876716614e-02, -5.339064076542854309e-02, -3.272879123687744141e-02, 1.961496919393539429e-01, 8.231151103973388672e-01],
[9.866137057542800903e-02, -1.816556304693222046e-01, 2.713682949542999268e-01, 6.095495223999023438e-01, -6.712981313467025757e-02],
[-2.152610421180725098e-01, 1.042345762252807617e+00, -3.065936863422393799e-01, 7.548590302467346191e-01, 2.216508835554122925e-01],
[3.166830241680145264e-01, 7.587897777557373047e-01, -1.701218634843826294e-01, -5.231039226055145264e-02, 3.498674035072326660e-01]
]);

var ch_w3 = ee.Array([
[6.590689420700073242e-01],
[-3.204468011856079102e+00],
[-1.072575822472572327e-01],
[-8.093237876892089844e-01],
[5.310226678848266602e-01]
]);

var ch_b1 = ee.Array.cat([ee.Array([
1.539840400218963623e-01,
-7.164982706308364868e-02,
-1.111535206437110901e-01,
1.958039999008178711e-01,
0.000000000000000000e+00,
3.606215119361877441e-01,
-7.742697000503540039e-02,
-2.993367612361907959e-01,
3.797425031661987305e-01,
0.000000000000000000e+00,
3.292617946863174438e-02,
3.113223006948828697e-03,
0.000000000000000000e+00,
2.499592723324894905e-03,
-1.294438689947128296e-01,
-2.784188389778137207e-01,
4.902017116546630859e-01,
-1.256251484155654907e-01,
1.930779516696929932e-01,
1.127850934863090515e-01,
1.744933724403381348e-01,
-1.377337984740734100e-02,
3.477760031819343567e-02,
9.337261319160461426e-02,
-9.324805438518524170e-02
])], 1).transpose();

var ch_b2 = ee.Array.cat([ee.Array([
0.000000000000000000e+00,
9.983327239751815796e-02,
1.044520786308567040e-06,
-6.828433275222778320e-02,
3.463256061077117920e-01
])], 1).transpose();

var ch_b3 = ee.Array.cat([ee.Array([-4.050421994179487228e-03])], 1).transpose();


var changeMLP = Object.create(neural.MLP.sigmoidMLP);
changeMLP.init(ee.List([ch_w1, ch_w2, ch_w3]), ee.List([ch_b1, ch_b2, ch_b3]));



// Поиск изменений на базе каналов:
// "tree_canopy_cover", "blue", "blue_1",  "green", "green_1", "red", "red_1",  "nir", "nir_1", "swir1", "swir1_1", "swir2", "swir2_1", "change"]
// blue == медианные срезы, blue_1 == ожидаемые медианные срезы
var ch_tc_w1 = ee.Array([
  
  
[-3.272196948528289795e-01, -1.332341283559799194e-01, -1.084390878677368164e-01, 5.534783005714416504e-01, 2.087877243757247925e-01, -2.025049552321434021e-02, 3.335442245006561279e-01, -1.688242107629776001e-01, 1.768589764833450317e-02, -1.916216015815734863e-01, -9.274902939796447754e-02, -7.050533592700958252e-02, -1.466632038354873657e-01, -3.990383744239807129e-01, -2.192187905311584473e-01, -1.705869734287261963e-01, 2.732147574424743652e-01, -5.703052133321762085e-02, 1.001945436000823975e-01, 6.920485943555831909e-02, 1.263002902269363403e-01, 5.341836065053939819e-02, 3.431647270917892456e-02, -4.402795433998107910e-01, -5.000909417867660522e-02],
[1.020886659622192383e+00, -9.526711702346801758e-01, -1.030259728431701660e-01, -7.611227035522460938e-02, 1.504598557949066162e-01, -1.071668416261672974e-01, 3.313221633434295654e-01, -1.097044423222541809e-01, 8.886189758777618408e-02, -1.542787253856658936e-01, -1.745235025882720947e-01, -1.970663964748382568e-01, 4.733873158693313599e-02, 6.734310388565063477e-01, -2.757989056408405304e-02, -1.228737831115722656e-01, 1.246306300163269043e+00, -1.903010487556457520e+00, 4.713503271341323853e-02, -4.668716713786125183e-02, 1.511706471443176270e+00, -5.753509700298309326e-02, -1.091885268688201904e-01, -7.080179452896118164e-01, -1.019591689109802246e-01],
[7.460005283355712891e-01, -6.850945353507995605e-01, -1.383641511201858521e-01, -3.247222900390625000e-01, 5.639771223068237305e-01, -1.250189244747161865e-01, -1.313792228698730469e+00, -6.206306070089340210e-02, 1.067609642632305622e-03, -5.981580168008804321e-02, -9.139572829008102417e-02, 8.398844301700592041e-02, -8.168394118547439575e-02, -1.254626512527465820e-01, -1.508656423538923264e-02, -2.303970903158187866e-01, 1.324461102485656738e-01, -1.026231870055198669e-01, -1.519470959901809692e-01, -7.670575380325317383e-02, 1.011656403541564941e+00, -1.629762947559356689e-01, 5.263672769069671631e-02, -2.715598642826080322e-01, 1.045787706971168518e-01],
[2.243211679160594940e-02, 9.253814071416854858e-02, -1.065747663378715515e-01, 2.698454856872558594e-01, -1.457274258136749268e-01, -2.369679063558578491e-01, 3.262724876403808594e-01, 4.076778516173362732e-02, -2.036478817462921143e-01, 4.436307400465011597e-02, -1.245843619108200073e-02, -1.936544477939605713e-01, 9.823287278413772583e-02, 1.130386367440223694e-01, -1.453454955480992794e-03, -1.068497747182846069e-01, 4.863569438457489014e-01, -4.853021204471588135e-01, -6.858799606561660767e-02, 1.064438670873641968e-01, 3.710811138153076172e-01, -1.719853430986404419e-01, 6.271348893642425537e-02, -4.815583527088165283e-01, -1.811732202768325806e-01],
[-1.076789572834968567e-01, -5.243738293647766113e-01, -1.548473685979843140e-01, -1.311900317668914795e-01, -6.350567936897277832e-02, 9.206432849168777466e-02, -1.525537133216857910e+00, 2.049365080893039703e-03, 1.039423327893018723e-02, -1.497546285390853882e-01, -1.777688600122928619e-02, -2.641717717051506042e-02, 1.715108454227447510e-01, -4.976590573787689209e-01, 3.056041896343231201e-02, 8.447242528200149536e-02, 6.463989019393920898e-01, 5.414054989814758301e-01, 2.040526270866394043e-02, -7.538502570241689682e-03, -3.050369918346405029e-01, 2.929538302123546600e-02, 2.021728269755840302e-02, -2.455407381057739258e-01, -4.439348354935646057e-02],
[-5.508041381835937500e-01, -2.574788630008697510e-01, 2.834530919790267944e-02, 7.392741739749908447e-02, -3.665284216403961182e-01, -1.985469087958335876e-02, -1.230580955743789673e-01, -6.360744684934616089e-02, 5.621175095438957214e-02, 3.615345805883407593e-02, -1.031476184725761414e-01, 4.827550053596496582e-02, -5.334373936057090759e-02, 1.611103266477584839e-01, -1.371818929910659790e-01, 1.427062600851058960e-01, -9.510951042175292969e-01, 6.785684823989868164e-01, 4.086474701762199402e-02, -1.767827421426773071e-01, 1.169399738311767578e+00, 6.989695876836776733e-02, -7.096935808658599854e-02, -1.061779379844665527e+00, 4.780003800988197327e-02],
[1.163053959608078003e-01, 7.074065208435058594e-01, -1.196245998144149780e-01, -3.161112777888774872e-03, -3.588147833943367004e-02, 7.824859023094177246e-02, -1.150157928466796875e+00, 3.054696321487426758e-02, 1.442274153232574463e-01, -1.328982114791870117e-01, 1.985512226819992065e-01, -9.349303692579269409e-02, -2.928711287677288055e-02, -7.373867034912109375e-01, 1.258695591241121292e-02, 7.655123621225357056e-02, -1.052914559841156006e-01, -2.399513274431228638e-01, -9.237235039472579956e-02, 1.148325391113758087e-02, 2.766290605068206787e-01, 7.097455114126205444e-02, -1.804836988449096680e-01, -1.730957329273223877e-01, 5.406361818313598633e-02],
[-1.717700004577636719e+00, 1.169926643371582031e+00, -1.152436956763267517e-01, 5.613054633140563965e-01, 2.299564480781555176e-01, -8.772281557321548462e-02, -3.748996257781982422e-01, -2.394534498453140259e-01, -6.895890086889266968e-02, 4.499705042690038681e-03, 1.096395328640937805e-01, -1.560921072959899902e-01, -1.136823818087577820e-01, -7.963209152221679688e-01, -3.247836977243423462e-02, 1.153837740421295166e-01, 1.971587538719177246e+00, -2.403926700353622437e-01, 2.283185720443725586e-02, 3.202095627784729004e-03, -2.084834098815917969e+00, -6.860081851482391357e-02, -1.407957375049591064e-01, 3.592588603496551514e-01, -5.378670990467071533e-02],
[-1.124001294374465942e-01, -5.315973609685897827e-02, 3.071919269859790802e-02, 1.141168177127838135e-01, 3.128660321235656738e-01, -9.570759721100330353e-03, 5.614597797393798828e-01, 9.492876008152961731e-03, -1.762477457523345947e-01, -4.563242197036743164e-02, -2.566051483154296875e-02, 2.285196781158447266e-01, 1.332044228911399841e-02, -4.960155785083770752e-01, 4.245328158140182495e-02, 1.366533711552619934e-02, -1.743986964225769043e+00, 6.068599820137023926e-01, 4.116397723555564880e-02, -7.868555933237075806e-02, 1.332890748977661133e+00, -1.090195253491401672e-01, 6.012307852506637573e-02, -9.269819855690002441e-01, -6.198870949447154999e-03],
[-4.646635651588439941e-01, -1.177571177482604980e+00, -7.513543963432312012e-02, 3.142641186714172363e-01, -8.430828452110290527e-01, -7.437723129987716675e-02, -4.161034226417541504e-01, -5.439986661076545715e-02, -6.264337897300720215e-02, -1.836708337068557739e-01, -1.623240858316421509e-01, -1.582536846399307251e-02, -2.017616666853427887e-02, 1.180558443069458008e+00, 1.103163883090019226e-01, 2.077794820070266724e-02, -1.567161798477172852e+00, 2.093010425567626953e+00, -1.093027219176292419e-01, -1.096267253160476685e-01, -2.556742727756500244e-01, -1.783046871423721313e-01, -1.370612233877182007e-01, -3.857962489128112793e-01, 1.241334080696105957e-01],
[8.572869896888732910e-01, 2.583878040313720703e+00, -1.795332133769989014e-02, -2.892623245716094971e-01, -6.923044919967651367e-01, 1.122157871723175049e-01, -1.121130585670471191e-01, 3.253628313541412354e-02, -9.700285643339157104e-02, -1.507394611835479736e-01, 3.316533938050270081e-02, 7.921040058135986328e-03, -9.964313358068466187e-02, -1.225754097104072571e-01, 8.714959770441055298e-02, 1.056202128529548645e-02, 5.221350193023681641e-01, -1.081488132476806641e+00, -4.424545913934707642e-02, 4.262288287281990051e-02, 9.753612428903579712e-02, -3.142498061060905457e-02, -4.533892124891281128e-02, 1.709176301956176758e-01, -5.427592620253562927e-02],
[5.277783870697021484e-01, -8.150990009307861328e-01, 3.946154192090034485e-02, 1.527331322431564331e-01, -4.554949998855590820e-01, -1.310585066676139832e-02, 3.226853609085083008e-01, 5.900675430893898010e-02, -2.219045311212539673e-01, -7.222880423069000244e-02, 1.384785473346710205e-01, 5.244204774498939514e-02, -1.970111429691314697e-01, 1.587614893913269043e+00, 1.000349223613739014e-01, -4.213128238916397095e-02, -1.389018416404724121e+00, 4.045208096504211426e-01, -2.318785758689045906e-03, -5.591156892478466034e-03, 1.480650305747985840e+00, -6.733120232820510864e-02, -8.843725174665451050e-02, -9.466511607170104980e-01, 1.314203441143035889e-01],
[7.642312049865722656e-01, 1.717198014259338379e+00, -1.533770412206649780e-01, -4.652311280369758606e-02, -5.873263347893953323e-03, 2.341587282717227936e-02, -2.040876001119613647e-01, -1.231462880969047546e-02, 2.373530901968479156e-02, -5.207703635096549988e-02, 2.281840192154049873e-03, -1.393216401338577271e-01, -3.409593552350997925e-02, -4.745240807533264160e-01, -3.964344039559364319e-02, 7.095411419868469238e-02, 8.329041004180908203e-01, -1.420233488082885742e+00, -1.366748511791229248e-01, -6.842021644115447998e-02, 4.710088670253753662e-01, 1.998115330934524536e-01, -5.169031210243701935e-03, -2.229433692991733551e-02, 1.896879673004150391e-01],


]);

var ch_tc_w2 = ee.Array([
  
[-1.317511349916458130e-01, 7.831411063671112061e-02, -6.477046012878417969e-01, 2.448175996541976929e-01, 9.173148870468139648e-02, -1.413641721010208130e-01, 1.284784793853759766e+00, -5.500919744372367859e-02, 6.873745918273925781e-01, 1.310787051916122437e-01, 2.488179802894592285e-01, -2.555367071181535721e-03],
[-1.135569065809249878e-01, 6.727897375822067261e-02, -1.027941226959228516e+00, -2.035387307405471802e-01, 1.672431081533432007e-01, -2.108277827501296997e-01, 1.551259040832519531e+00, 8.118522167205810547e-02, 2.895233631134033203e-01, 2.123671956360340118e-02, 1.064565539360046387e+00, -1.399942487478256226e-01],
[1.402029544115066528e-01, 1.144542023539543152e-01, -7.884842902421951294e-02, -9.804066270589828491e-03, -2.872272208333015442e-02, 1.574455499649047852e-01, -1.620438694953918457e-01, 6.808831356465816498e-03, 8.852285891771316528e-02, 4.664990678429603577e-02, 1.545088589191436768e-01, -2.469745650887489319e-02],
[-5.608827248215675354e-02, -1.321048736572265625e-01, 4.608825445175170898e-01, -3.282888233661651611e-01, -1.108693778514862061e-01, -6.193099021911621094e-01, 9.516642987728118896e-02, -7.475362718105316162e-02, 4.031967818737030029e-01, -1.549763977527618408e-01, 3.807716071605682373e-01, -1.000731438398361206e-01],
[5.184808373451232910e-02, -4.624954238533973694e-02, -6.709437370300292969e-01, 4.959809184074401855e-01, 1.672539263963699341e-01, -1.026154011487960815e-01, 7.960523962974548340e-01, 3.828832134604454041e-02, 5.399732589721679688e-01, 1.942483931779861450e-01, 4.576427638530731201e-01, 2.847510576248168945e-02],
[4.413856659084558487e-03, -1.429634690284729004e-01, -9.373645484447479248e-02, 4.028552770614624023e-02, -1.604941114783287048e-02, -1.348692327737808228e-01, 2.639802731573581696e-02, 1.163865774869918823e-01, 1.057106405496597290e-01, -7.813102751970291138e-02, 9.786560200154781342e-03, -1.447035521268844604e-01],
[-5.449554696679115295e-02, -2.779431641101837158e-01, -5.374785885214805603e-02, -1.006565392017364502e-01, -4.692226275801658630e-02, -2.870566248893737793e-01, 1.002789139747619629e+00, -1.888414025306701660e-01, -1.291706085205078125e+00, -1.650618612766265869e-01, 7.630714774131774902e-01, 8.423492312431335449e-03],
[-6.914079189300537109e-02, 3.618445247411727905e-02, -5.675827339291572571e-02, 3.609957173466682434e-02, -1.344004273414611816e-01, -1.877720504999160767e-01, 1.622409224510192871e-01, 8.146665059030056000e-03, -6.827258970588445663e-03, -8.454950153827667236e-02, 9.342364966869354248e-02, 2.776847779750823975e-02],
[1.009284611791372299e-02, -3.400172665715217590e-02, 7.055463641881942749e-02, 8.986862376332283020e-03, -1.709654331207275391e-01, -7.386405020952224731e-02, -6.620686501264572144e-02, 5.577891133725643158e-03, 1.114568710327148438e-01, 1.271422300487756729e-02, -1.287872157990932465e-02, -8.574623614549636841e-03],
[4.795537889003753662e-02, 2.021971642971038818e-01, 2.422761730849742889e-02, -4.732723534107208252e-02, 6.661370396614074707e-02, 1.442970186471939087e-01, -1.184143405407667160e-02, -5.289440974593162537e-02, 5.101074650883674622e-02, -7.524292916059494019e-02, 1.377526372671127319e-01, 9.869613498449325562e-02],
[7.766685634851455688e-02, 4.271930456161499023e-02, -4.178636148571968079e-02, -2.985175140202045441e-02, 1.112496256828308105e-01, -2.640116214752197266e-02, -2.168887704610824585e-01, 1.098522990942001343e-01, 1.116855628788471222e-02, -2.665065787732601166e-02, 1.501561515033245087e-02, 1.725542396306991577e-01],
[1.156552731990814209e-01, -2.292743884027004242e-02, 8.390299975872039795e-03, -7.077416777610778809e-02, 8.058292418718338013e-02, 8.854487538337707520e-02, 1.387898474931716919e-01, 5.366180837154388428e-02, -8.065895177423954010e-03, -1.313473880290985107e-01, 1.056066229939460754e-01, -8.261048793792724609e-02],
[2.512147277593612671e-02, 1.029645800590515137e-01, 5.330306291580200195e-02, -7.207409944385290146e-03, 2.138254046440124512e-01, -3.521142154932022095e-02, 2.515648119151592255e-02, 1.254822313785552979e-01, 1.203746423125267029e-01, 6.669966131448745728e-02, 1.223866641521453857e-01, -6.111383438110351562e-02],
[-1.142529118806123734e-02, -3.024495020508766174e-02, -1.065003752708435059e+00, 1.336819052696228027e+00, 5.524640437215566635e-04, 5.380659699440002441e-01, 1.506887555122375488e+00, 9.846337884664535522e-02, -1.113245487213134766e-01, 5.292130634188652039e-02, 1.601188182830810547e-01, -1.098573431372642517e-01],
[-1.636337339878082275e-01, -2.030194848775863647e-01, 1.643104106187820435e-02, -1.585812568664550781e-01, 1.052553132176399231e-01, 1.270298808813095093e-01, -8.747759275138378143e-04, -1.236492097377777100e-01, -1.189770549535751343e-01, 2.126226723194122314e-01, 1.932312548160552979e-01, -1.221744716167449951e-01],
[-9.576553106307983398e-02, -1.375323161482810974e-02, -1.199688985943794250e-01, -9.115738421678543091e-02, 3.632216900587081909e-02, -8.577279746532440186e-02, -8.152794837951660156e-02, 5.567632615566253662e-02, 4.050421342253684998e-02, 5.120598897337913513e-02, -8.362382650375366211e-02, -5.938585102558135986e-02],
[-3.508717194199562073e-02, 2.780135869979858398e-01, 9.010506868362426758e-01, 8.681099861860275269e-02, -5.321094393730163574e-02, 8.718164563179016113e-01, -1.215359210968017578e+00, -9.738872759044170380e-03, -7.820318937301635742e-01, -1.655515283346176147e-01, -1.526282668113708496e+00, 1.420184783637523651e-02],
[-1.070797145366668701e-01, -5.908754840493202209e-02, 8.871079683303833008e-01, -3.296707868576049805e-01, 6.278783828020095825e-02, -1.686182767152786255e-01, -6.253938078880310059e-01, -6.964616477489471436e-02, -1.597955346107482910e+00, -1.800083070993423462e-01, -1.176897525787353516e+00, -3.616150841116905212e-02],
[1.464873086661100388e-02, 9.430286288261413574e-02, -1.923797279596328735e-02, 4.461220279335975647e-02, 1.282102316617965698e-01, 5.579913035035133362e-02, 4.088838398456573486e-02, -1.001664549112319946e-01, 5.779958143830299377e-02, 1.173574477434158325e-01, -7.731980085372924805e-02, 1.476669758558273315e-01],
[1.095970720052719116e-01, -7.393313944339752197e-02, 1.826639771461486816e-01, 1.486127227544784546e-01, -1.243832632899284363e-01, -4.598164930939674377e-02, 7.778738439083099365e-02, 6.326237320899963379e-02, 2.116142809391021729e-01, 5.034931749105453491e-02, 1.648412644863128662e-02, 6.994123011827468872e-02],
[-2.813802361488342285e-01, 3.273734450340270996e-01, -1.095289111137390137e+00, 7.521646022796630859e-01, -1.573996841907501221e-01, 1.556245610117912292e-02, 1.127534747123718262e+00, -1.371039450168609619e-01, -3.175550401210784912e-01, -1.695463508367538452e-01, 1.254270225763320923e-01, -9.094742685556411743e-02],
[8.088333904743194580e-02, 1.009466573596000671e-01, 2.904120460152626038e-02, 1.257663667201995850e-01, -5.303225293755531311e-02, -3.099283389747142792e-02, -5.657610017806291580e-03, -1.250989269465208054e-02, 8.903230726718902588e-02, -6.278592348098754883e-02, 3.036579675972461700e-02, -8.976472169160842896e-02],
[1.432179659605026245e-01, 6.993327289819717407e-02, 1.751288585364818573e-02, -9.597609192132949829e-02, -7.698718458414077759e-02, -1.944263465702533722e-02, -5.687417834997177124e-02, -7.617049850523471832e-03, 7.100497186183929443e-02, 3.861429914832115173e-02, -9.999953210353851318e-02, 1.418868899345397949e-01],
[-7.535805553197860718e-02, -2.666452527046203613e-02, -7.935186028480529785e-01, 1.661035977303981781e-02, -7.433790713548660278e-03, 1.825949251651763916e-01, 1.331057429313659668e+00, 6.297916918992996216e-02, 6.758902221918106079e-03, -1.457225382328033447e-01, 9.288668036460876465e-01, -8.109292387962341309e-02],
[-2.920998260378837585e-02, -1.583236083388328552e-02, -3.792307153344154358e-02, -2.360580302774906158e-02, -8.325944840908050537e-02, -6.273727864027023315e-03, -1.288298219442367554e-01, 4.811871051788330078e-02, -9.188006073236465454e-02, -1.460659652948379517e-01, 1.475432217121124268e-01, -1.524837315082550049e-01],


]);

var ch_tc_w3 = ee.Array([

[8.488564938306808472e-02],
[-5.451207756996154785e-01],
[2.301030874252319336e+00],
[-1.502499938011169434e+00],
[-8.301208913326263428e-02],
[-1.213677287101745605e+00],
[-3.105175495147705078e+00],
[-2.952125370502471924e-01],
[-2.376435995101928711e+00],
[-2.797188162803649902e-01],
[-2.378034591674804688e+00],
[9.029024839401245117e-02]

]);

var ch_tc_b1 = ee.Array.cat([ee.Array([
  
3.518332242965698242e-01,
-7.474108133465051651e-03,
-1.358940362930297852e+00,
-4.059956371784210205e-01,
-2.133186906576156616e-01,
-7.837541699409484863e-01,
2.808178365230560303e-01,
-1.622667789459228516e+00,
-4.565699696540832520e-01,
9.073989349417388439e-05,
-9.115809574723243713e-03,
5.328656360507011414e-02,
-2.136900275945663452e-02,
2.148042023181915283e-01,
7.512389682233333588e-03,
-3.454533815383911133e-01,
-4.491634964942932129e-01,
2.047235965728759766e-01,
-3.533309400081634521e-01,
-2.506560981273651123e-01,
-4.521847367286682129e-01,
4.381094593554735184e-03,
-1.446106284856796265e-01,
7.788233160972595215e-01,
-1.709375083446502686e-01,

])], 1).transpose();

var ch_tc_b2 = ee.Array.cat([ee.Array([
-1.113407254219055176e+00,
-4.054901897907257080e-01,
1.464699804782867432e-01,
6.709485501050949097e-02,
-1.649895459413528442e-01,
-1.011087968945503235e-01,
2.745544770732522011e-04,
-1.303932189941406250e+00,
3.051689267158508301e-01,
6.429392099380493164e-02,
1.980503499507904053e-01,
-2.708766236901283264e-02,
])], 1).transpose();

var ch_tc_b3 = ee.Array.cat([ee.Array([4.590133130550384521e-01,])], 1).transpose();


var changeTreeCoverMLP = Object.create(neural.MLP.sigmoidMLP);
changeTreeCoverMLP.init(ee.List([ch_tc_w1, ch_tc_w2, ch_tc_w3]), ee.List([ch_tc_b1, ch_tc_b2, ch_tc_b3]));


//////////////////////////////////////////////////
// Облака
//////////////////////////////////////////////////

// Порядок слоев: 
// "blue", "green", "red", "nir", "swir1", "swir2", "ndsi"

var cl_w1 = ee.Array([
  
[-9.087566137313842773e-01, -5.786538124084472656e-01, 1.106859207153320312e+00, 6.163979768753051758e-01, -5.411292240023612976e-02, -5.591741763055324554e-03, -6.362034380435943604e-02, 6.362378001213073730e-01, -1.645414158701896667e-02, -1.289477944374084473e+00, -5.416497588157653809e-01, 1.158324480056762695e+00],
[-3.265578150749206543e-01, 1.692616343498229980e-01, 7.367844581604003906e-01, -1.105198621749877930e+00, -4.586433246731758118e-02, 7.627364993095397949e-02, 2.211483381688594818e-02, 5.701655149459838867e-01, -3.889114304911345243e-04, -9.615105986595153809e-01, -1.474421739578247070e+00, -2.706050872802734375e-01],
[-4.518366754055023193e-01, 4.066804349422454834e-01, 2.582222819328308105e-01, -6.104081869125366211e-01, 3.923160582780838013e-02, 5.377371609210968018e-02, 1.195267289876937866e-01, 5.510318279266357422e-01, -1.270864158868789673e-01, 1.188552498817443848e+00, -7.426695823669433594e-01, 5.764303207397460938e-01],
[1.542117744684219360e-01, -2.380799502134323120e-01, -7.438500523567199707e-01, 7.573539018630981445e-01, 1.103594247251749039e-02, 2.395975898252800107e-04, -6.531942635774612427e-02, 2.734312415122985840e-01, 4.472167789936065674e-02, 9.067352414131164551e-01, -1.804043501615524292e-01, -4.875796735286712646e-01],
[3.656126856803894043e-01, 1.233669742941856384e-01, 6.734394431114196777e-01, -8.622140884399414062e-01, 8.249205537140369415e-03, -1.067510247230529785e-01, -9.779623895883560181e-02, -6.260270476341247559e-01, 1.333588659763336182e-01, -5.729764699935913086e-02, -4.493030309677124023e-01, 2.407638281583786011e-01],
[-2.185143530368804932e-01, -1.211623787879943848e+00, -2.738050222396850586e-01, 1.260315299034118652e+00, -1.284549385309219360e-01, 5.700468644499778748e-02, -1.504130754619836807e-02, 4.056728482246398926e-01, -6.282173097133636475e-02, -1.808506965637207031e+00, 8.818404078483581543e-01, -1.338979005813598633e+00],
[-5.926322340965270996e-01, 1.230625391006469727e+00, -8.196741342544555664e-01, 1.054537773132324219e+00, -8.808226138353347778e-02, -9.109745174646377563e-02, -7.382538169622421265e-02, 5.579175949096679688e-01, 1.262612454593181610e-02, -6.124804615974426270e-01, -5.242663025856018066e-01, 1.137628316879272461e+00],

]);

var cl_w2 = ee.Array([
  
[8.565744757652282715e-02, -7.164090871810913086e-03, 2.900516688823699951e-01, 2.894863300025463104e-02, -1.047525525093078613e+00, -6.519927084445953369e-02, 4.808093011379241943e-01, 2.725254558026790619e-02, 4.551149904727935791e-02, -4.744846746325492859e-02, -3.831886500120162964e-02, -5.904761329293251038e-02],
[-1.031562965363264084e-02, -1.105835475027561188e-02, -3.191884607076644897e-02, -2.230723947286605835e-01, -1.343338966369628906e+00, -8.624970912933349609e-02, 9.376445412635803223e-01, -6.375851482152938843e-02, -1.393843889236450195e-01, -1.792336115613579750e-03, -1.012127567082643509e-02, -4.569424092769622803e-01],
[-4.243198409676551819e-02, -6.212189421057701111e-02, 8.243510723114013672e-01, -7.715929299592971802e-02, 7.418082356452941895e-01, 3.317281231284141541e-02, -1.301020264625549316e+00, -4.260182008147239685e-02, -1.390337944030761719e-01, -4.784341901540756226e-02, 7.019797712564468384e-02, 7.431803345680236816e-01],
[7.221354544162750244e-02, 4.301628097891807556e-03, 3.941838070750236511e-02, -3.667953982949256897e-02, 1.846237301826477051e+00, 2.636194601655006409e-02, 6.719035506248474121e-01, -2.188949100673198700e-02, -2.715269289910793304e-02, -7.760174106806516647e-03, -9.591058641672134399e-02, -2.074633240699768066e-01],
[4.679852724075317383e-02, 1.466750651597976685e-01, -2.956276200711727142e-02, -1.551403431221842766e-03, -2.810375206172466278e-02, 1.347847469151020050e-02, -9.287575632333755493e-02, 6.772935390472412109e-02, 8.925119042396545410e-02, -3.678441792726516724e-02, -3.407211042940616608e-03, 5.432292446494102478e-02],
[4.972476139664649963e-02, 1.072168797254562378e-01, 3.548099473118782043e-02, -2.117450535297393799e-02, -3.430821001529693604e-02, -7.267304230481386185e-03, 7.765052374452352524e-03, 6.416194140911102295e-02, -7.139963656663894653e-02, 2.227141521871089935e-03, 5.609971284866333008e-02, 1.532007823698222637e-03],
[1.133072003722190857e-01, 7.147372514009475708e-02, -2.083099912852048874e-03, -4.002020228654146194e-03, -1.716162078082561493e-02, 1.250236183404922485e-01, -1.980074867606163025e-02, -1.355955302715301514e-01, 7.782335393130779266e-03, 4.360144585371017456e-02, -5.230345949530601501e-02, -8.722512423992156982e-02],
[-5.108147487044334412e-02, 5.359483882784843445e-02, -1.865903139114379883e-01, -1.278146207332611084e-01, -1.930562853813171387e-01, -5.896537750959396362e-02, 3.704356551170349121e-01, -5.094629898667335510e-02, -7.598984986543655396e-02, -1.143100336194038391e-01, -9.927751123905181885e-02, 1.348200201988220215e+00],
[-5.564073473215103149e-02, 9.007992222905158997e-03, -4.653389565646648407e-03, -6.149697117507457733e-03, -7.161553949117660522e-02, 3.786090761423110962e-02, 6.590066011995077133e-03, -1.003979705274105072e-02, -4.002841189503669739e-02, -1.132877543568611145e-01, -7.440181076526641846e-02, 5.354397743940353394e-02],
[1.169824413955211639e-02, 1.082045026123523712e-03, 2.517029047012329102e-01, -4.147730171680450439e-01, 2.510078430175781250e+00, -5.968592129647731781e-03, 1.022419929504394531e+00, -3.090222738683223724e-02, -2.178431721404194832e-03, 6.415283679962158203e-02, -9.810942225158214569e-03, -7.201880216598510742e-02],
[-1.766300201416015625e-02, 6.598925590515136719e-02, 3.467397093772888184e-01, 4.792367219924926758e-01, 1.168074369430541992e+00, 5.340804159641265869e-02, 1.276488780975341797e+00, -7.411900162696838379e-02, 1.903991959989070892e-02, 2.693911269307136536e-02, 1.056246832013130188e-01, -9.867604821920394897e-02],
[-4.579732939600944519e-02, -1.219366118311882019e-01, -2.835810482501983643e-01, -1.232504487037658691e+00, 1.071342110633850098e+00, -8.892473764717578888e-03, 6.304526925086975098e-01, 6.576623022556304932e-02, 1.297488659620285034e-01, -2.951500192284584045e-02, 8.265530318021774292e-02, 1.465760022401809692e-01],


]);

var cl_w3 = ee.Array([

[3.405951708555221558e-02],
[-4.187493026256561279e-02],
[-1.072157740592956543e+00],
[1.376748919486999512e+00],
[-3.746932506561279297e+00],
[7.173458486795425415e-02],
[-2.532652616500854492e+00],
[3.518235683441162109e-02],
[7.793343067169189453e-02],
[-5.964971333742141724e-02],
[4.213052242994308472e-02],
[1.704744338989257812e+00],


]);

var cl_b1 = ee.Array.cat([ee.Array([
  
  
5.442374348640441895e-01,
2.828808128833770752e-01,
-1.168965362012386322e-02,
-1.125227138400077820e-01,
-1.614382863044738770e-01,
-7.177234292030334473e-01,
-2.088828571140766144e-02,
-3.130301535129547119e-01,
-4.571204483509063721e-01,
3.358498215675354004e-01,
1.028457641601562500e+00,
2.108809351921081543e-01


])], 1).transpose();

var cl_b2 = ee.Array.cat([ee.Array([
  
  
-3.896180391311645508e-01,
-5.121287330985069275e-02,
-5.940874218940734863e-01,
2.084265351295471191e-01,
-4.590041339397430420e-01,
-7.325657010078430176e-01,
-8.229070305824279785e-01,
-5.022934079170227051e-01,
-6.899069994688034058e-02,
-2.564021199941635132e-02,
-2.757515609264373779e-01,
-1.520217418670654297e+00,


])], 1).transpose();

var cl_b3 = ee.Array.cat([ee.Array([
  
2.826256155967712402e-01,

])], 1).transpose();

var cloudMLP = Object.create(neural.MLP.sigmoidMLP);
cloudMLP.init(ee.List([cl_w1, cl_w2, cl_w3]), ee.List([cl_b1, cl_b2, cl_b3]));


exports.MLP={
  trained: changeMLP,
  changeDetectorTreeCover: changeTreeCoverMLP,
  changePoisson: changePoisson,
  cloudDetector: cloudMLP
};
