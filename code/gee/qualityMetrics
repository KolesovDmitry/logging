

// Выборка точек размером в count штук из растров в заданном масштабе
function sampleRasters(rasterList, count, scale){
        
  var data = ee.Image.cat(rasterList);
  var mask = data.reduce(ee.Reducer.allNonZero());
  data = data.updateMask(mask);

  var points = data.sample({'region': null, 'scale': scale, 'numPixels': count, 'seed': 0});
        
  return points;
}

function qualityMSE(predictedImg, expectedImg, scale){
// predictedImg, expectedImg - одноканальные растры, для которых проверяется сходство

  var diff = predictedImg.subtract(expectedImg);
  var sq = diff.multiply(diff);
  
  var params = {'reducer': ee.Reducer.mean(), 'geometry': null, 'scale': scale, 'bestEffort': true};
  var sample = sq.reduceRegion(params);
  
  return sample;
}

exports.Quality = {
  MSE: qualityMSE
};


